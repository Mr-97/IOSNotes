iOS开发中的MVVM
==============

只要做过程序开发一段时间都应该知道最基础的MVC——Model-View-Controller，它是构建程序的标准方法。但MVC有缺陷，当需求由简单变复杂，数据模型不能满足需求时，MVC反而会成为阻碍。它会让视图和数据模型的对接变得十分复杂，model变更，视图与model对接的控制器也会跟着改变，这是一个复杂的过车给你，肯定不是我们想做的，特别是在时间紧迫的情况下。

而我在开发的过程中正好遇到，需求的频繁变更，在原有的数据模型下已经很难适应新的需求。在思考过后我决定用MVVM解决，重新处理原来的model，给主要的控制配置一个view-model，问题变得简单起来。代码的扩展性变强，新增的需求也几乎没有让代码量增加。

下面，我们来了解一个MVC和MVVM。

Model-View-Controller
---------------------

Model-View-Controller是组织代码的基本范式，iOS下也同样如此。在MVC模式下，所有对象都属于数据模型、视图或者控制器中的一种。数据模型保存数据，视图给用户呈现可交互界面，控制器控制数据模型和视图的交互关系。

![MVC](https://github.com/taylor1003/IOSNotes/raw/master/image/mvvm/mvc1.png "MVC")

上图中，不管任何种类的用户输入，视图都会通知控制器。然后控制器更新模型以便反应状态的改变。被改变的模型（典型的数据模型是键值对）通知相应控制器它已经做出改变，控制器需要在试图上反应出来。很多程序就是在这样的流程下写出来的，包括iOS程序。

iOS中MVC的缺陷不仅体现在需求的频繁变更和model的不合理上，还有控制器需要同时管理控制逻辑、业务逻辑，这会让代码可读性降低，测试困难。

Model-View-ViewModel
--------------------

理想情况下，MVC可能会很有效。然而，世界太复杂，MVC太简单。在很多情况下，MVC并不能很好的适应复杂的需求。所以我们有了另一个选择:Model-View-ViewModel.

MVVM最初由微软提出，它跟MVC非常相似，但它是一个更懂变通的孩子。如果MVC是个少年，MVVC已经是成人了。它通过一种自然的形式紧紧的将视图和控制器耦合在一起，还推出了一个新的组成部分。

![MVVM](https://github.com/taylor1003/IOSNotes/raw/master/image/mvvm/mvvm1.png "MVVM")

在MVVM中，视图和控制器正式的连接在一起，我们可以将它们视为一体。视图不仅仍然不用被主动参照model，还不用被控制器影响，而是被视图模型(view model)影响。

视图模型是一个用来放置用户输入的确认逻辑、展示逻辑的有效方法，在处理网络请求和其他混杂代码的时候它同样有效。

MVVM不仅是解决iOS端复杂逻辑的利器，同样，它具有高可测试行的特性。

我的项目中只是简单的构造出一个视图模型(view model)，不仅适应了新的需求，还兼容旧的需求。它强大的扩展性已经表露无遗，后面鉴于我对MVVM的了解太粗浅，暂时不介绍。